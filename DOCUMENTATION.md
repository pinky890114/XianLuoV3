
# 「Nocy餅舖」委託系統功能說明文件

本文件旨在說明「暹羅的賠錢生意」應用程式中，「Nocy餅舖」模組的主要功能與設計。

---

## 1. 前台功能 (Client-Facing Features)

使用者可以透過網站前台與「Nocy餅舖」進行互動，包含了解產品、選購周邊，以及最重要的「認養」（委託訂製）小餅。

### 1.1. 小餅介紹 (`/nocy-boutique`)

- **功能**: 作為「Nocy餅舖」的入口頁面，向使用者介紹什麼是「小餅」娃娃。
- **內容**: 包含說明文字、實際成品照片，以及一個醒目的「帶走小餅」按鈕，引導使用者前往委託流程。
- **目的**: 吸引新使用者，並建立對產品的基本認識。

### 1.2. 小餅用品 (`/nocy-boutique/supplies`)

- **功能**: 展示與小餅搭配使用的周邊商品。
- **介面**:
    - **商品列表**: 以網格卡片形式清晰展示四種商品：「基礎款立牌包」、「A5活頁收納袋」、「保護膜標籤紙」和「保麗龍膠」。
    - **彈出式說明**: 點擊任一商品卡片，會以彈出式視窗（Modal）顯示詳細資訊，包含價格、大圖、規格與使用說明。使用者關閉視窗後即可繼續瀏覽，無需換頁。
- **目的**: 提供一站式購物體驗，增加附加價值，並提升使用者介面的流暢度。

### 1.3. 小餅認養 - 委託精靈 (`/nocy-boutique/adoption`)

這是一個三步驟的引導式表單，旨在簡化複雜的委託流程，確保使用者提供完整資訊。

- **步驟一：委託說明**
    - **內容**: 詳細說明委託的價格結構、注意事項（如非買斷）、以及需要提供的資料類型（如 OC 立繪、遊戲截圖等）。
    - **目的**: 設定使用者預期，確保雙方對委託細節有共識。

- **步驟二：委託流程**
    - **內容**: 清晰解釋從提供圖片、報價、付款，到效果圖確認、製作、集運、最終寄送的完整時間線與流程。
    - **目的**: 讓使用者了解整個委託的生命週期，增加信任感。

- **步驟三：委託單填寫**
    - **功能**: 核心的訂單資訊收集表單。
    - **欄位**:
        - **暱稱**、**委託標題**: 必填的基本資訊。
        - **頭飾工藝**: 提供「一體」、「可拆」、「夾式」三種選項，並附有彈出式圖文說明，幫助使用者理解差異。
        - **說明圖上傳**: 使用者可上傳最多 5 張參考圖片。系統內建了客戶端的圖片壓縮功能，能自動將圖片轉換為 WebP 格式並最佳化，加快上傳速度並節省儲存空間。
        - **加價購**: 提供多種周邊商品供使用者勾選。
        - **備註欄**: 供使用者填寫額外需求。
    - **即時報價**: 系統會根據基礎價格與選擇的加價購項目，即時計算並顯示預估總金額。
    - **訂單提交**:
        - 成功提交後，訂單資料會寫入 Firebase Firestore 資料庫。
        - 同時，系統會透過 Webhook 自動向指定的 Discord 頻道發送一則新訂單通知，方便管理員即時掌握。
        - 最後，頁面會顯示一個成功提示，並附上小餅的養護指南。

---

## 2. 後台管理功能 (Admin Features)

管理員擁有專屬的後台儀表板，用以管理所有「Nocy餅舖」的訂單。

### 2.1. 訂單儀表板 (`/admin/dolls`)

- **功能**: 集中展示所有小餅訂單。
- **介面**: 以表格形式列出所有訂單，包含訂單編號、暱稱、標題、金額與當前狀態。
- **載入體驗**: 進入頁面時，會明確顯示「正在讀取訂單資料...」，優化了使用者對於資料載入時間的感知。

### 2.2. 訂單管理

- **手動新增訂單**:
    - 管理員可透過彈出式表單手動建立新訂單，適用於線下或特殊情況的委託。

- **編輯現有訂單**:
    - 點擊「編輯」按鈕後，會彈出一個功能完整的編輯視窗。
    - **可編輯項目**:
        - **訂單狀態**: 可從預設的狀態列表中更新，例如從「委託成立」更新至「效果圖繪製中」。
        - **總金額**: 可手動修改訂單總價。
        - **委託備註**: 可修改客戶最初填寫的備註。
        - **新增備註 (不可修改)**: 管理員可以追加新的內部備註，並自動附上時間戳，方便追蹤。
        - **上傳進度圖片**: 管理員可以上傳製作過程中的圖片（如效果圖、成品圖），這些圖片會顯示在客戶的訂單查詢頁面。

---

## 3. 通用功能 (Shared Features)

### 3.1. 訂單進度查詢 (`/order-status`)

- **功能**: 一個公開的查詢頁面，讓客戶能隨時追蹤自己的訂單進度。
- **查詢方式**: 可使用「暱稱」或「訂單編號」進行查詢。
- **顯示內容**:
    - 訂單基本資訊。
    - **視覺化進度條**: 以時間軸的形式清晰展示訂單目前處於哪個階段。
    - **進度預覽圖**: 顯示管理員在後台上傳的所有進度圖片。
    - **掌櫃備註**: 顯示管理員新增的所有公開備註。
